<!-- pages/observation-question/index.wxml -->
<view class="container">
  <view class="header">
    <view class="title-section">
      <text class="main-title">今日侦查密码</text>
      <text class="sub-title">记录你的观察发现</text>
    </view>
  </view>

  <!-- 干支显示区域 -->
  <view class="ganzhi-section" wx:if="{{ganZhi && ganZhi !== '未知'}}">
    <view class="ganzhi-content">
      <!-- 干支文字在上 -->
      <text class="ganzhi-text">{{ganZhi}}</text>
      
      <!-- 干支图片在中间 -->
      <view class="ganzhi-image-section" wx:if="{{ganZhiImage}}">
        <image 
          class="ganzhi-image" 
          src="{{ganZhiImage}}" 
          mode="aspectFit"
          binderror="onImageError"
          bindload="onImageLoad"
        ></image>
      </view>
      
      <!-- "今日密码"文字在图片下面 -->
      <text class="ganzhi-label">今日密码</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-section" wx:if="{{isLoading}}">
    <text class="loading-text">正在获取今日密码...</text>
  </view>

  <!-- 谜题卡片 -->
  <view class="card puzzle-card">
    <view class="card-header">
      <text class="card-title">今日谜题</text>
    </view>
    <view class="card-content">
      <text class="puzzle-text">仔细观察今日的干支组合，记录你的发现和推理过程。每一个细节都可能成为解开谜题的关键。</text>
    </view>
  </view>

  <!-- 输入区域 -->
  <view class="card input-card">
    <view class="card-header">
      <text class="card-title">观察记录</text>
    </view>
    <view class="card-content">
      <textarea 
        class="observation-input" 
        placeholder="请在此记录今日‘侦查密码’在你世界中的显影…它可能是一个闪念、一段对话、一种情绪，或任何让你‘心有所动’的瞬间。" 
        bindinput="onInputChange"
        value="{{observationText}}"
        maxlength="500"
        show-confirm-bar="{{false}}"
      ></textarea>
      <view class="char-count">
        <text>{{observationText.length}}/500</text>
      </view>
    </view>
  </view>

  <!-- 提交按钮 -->
  <view class="submit-section">
    <button class="submit-btn" bindtap="onSubmit" hover-class="button-hover">
      <text class="btn-text">提交观察</text>
    </button>
  </view>

  <!-- 底部提示 -->
  <view class="footer-tip">
    <text class="tip-text">侦探官，真相将在今夜23:30揭晓</text>
  </view>
</view>